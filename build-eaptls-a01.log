https://wiki.alpinelinux.org/wiki/FreeRadius_EAP-TLS_configuration
https://networkradius.com/doc/3.0.10/raddb/tls/tls-config_tls-common.html

mount -t 9p -o trans=virtio /dev/share /root/share

apt install -y bridge-utils hostapd freeradius freeradius-utils freeradius-ldap ifupdown tree iw make openvswitch-switch

iw list | tee wls7.hwinfo

mkdir -p /etc/network/interfaces.d/

mv wls7.cfg interfaces.d/
vim /etc/network/interfaces 
wget 172.1.0.191/server_build.log
cp -f network.d/wls7.cfg /etc/network/interfaces.d/
vim interfaces.d/apd.cfg
mkdir /root/eaptls
mkdir /root/eaptls/CertAuthority /root/eaptls/contrib /root/eaptls/hostapd /root/eaptls/interfaces.d/ /root/eaptls/radius/ /root/eaptls/bak/
mkdir /root/eaptls/bak/ssl /root/eaptls/bak/hostapd /root/eaptls/bak/radius/
mkdir ~/eaptls/contrib/ssl
cp CertAuthority/mkcert ~/eaptls/contrib/ssl/
cp CertAuthority/openssl.cnf ~/eaptls/contrib/ssl/
vim ~/eaptls/contrib/ssl/
clear
ls
clear; ls
chmod +x ~/eaptls/contrib/ssl/mkcert 
mv ~/eaptls/contrib/ssl/mkcert ~/eaptls/contrib/ssl/init-guided.ca
clear
ln -f ~/eaptls/contrib/ssl/init-guided.ca /etc/ssl/
cp -f /etc/ssl/openssl.cnf ~/eaptls/bak/
vim ~/eaptls/bak/openssl.cnf 
ln -f ~/eaptls/contrib/ssl/openssl.cnf /etc/ssl/openssl.cnf 
ls
clear
ls
ls old/
rmdir  old/
clear; ls
ls CertAuthority/
clear; ls
mv CertAuthority/ contrib/
mkdir ssl
clear
ln /etc/ssl/init-guided.ca /etc/ssl/openssl.cnf ssl/
clear
ls
ls ~
ls ~/eaptls/
mv ~/eaptls/CertAuthority/ ~/eaptls/contrib/
cd radius/
ls
clear
ls
ls bak/
clear
ls bak/
clear
ls
ls contrib/
ls freeradius/
ln -s /etc/freeradius /root/eaptls/radius/
ls /root/eaptls/radius/
mkdir ~/eaptls/bak/radius/freeradius
cp /etc/freeradius/3.0/clients.conf /root/eaptls/bak/radius/freeradius/
cp /etc/freeradius/3.0/users /root/eaptls/bak/radius/freeradius/
ls /etc/freeradius/3.0/certs/
vim /etc/freeradius/3.0/certs/
find /etc/ -name "eap.conf"
find /etc/ -name "*eap*"
clear
ls
ls freeradius/
clear
ls
vim .
ls
vim freeradius/clients.conf 
vim ~/eaptls/radius/freeradius/3.0/clients.conf 
ls
ls freeradius/
ls contrib/
vim ~/eaptls/radius/freeradius/3.0/users 
vim /etc/freeradius/3.0/users 
vim /etc/freeradius/3.0/
apt-cache search radius | grep tls
apt-cache search radius | grep -i tls
apt-cache search radius
apt-cache search radius | grep -i mod
ckear
clear
l
clear; ls
ls contrib/
vim /etc/freeradius/3.0/users 
clear
ls contrib/
vim contrib/eap.conf 
cp contrib/eap.conf /root/eaptls/radius/freeradius/eap.conf
ln -f /root/eaptls/radius/freeradius/eap.conf /etc/freeradius/
vim /etc/freeradius/eap.conf 
vim /etc/freeradius/
ln -f /root/eaptls/radius/freeradius/eap.conf /etc/freeradius/3.0/
rm /etc/freeradius/eap.conf 
clear; ls
im /etc/freeradius/
clear; ls
vim /etc/freeradius/3.0/radiusd.conf 
vim /etc/freeradius/3.0/policy.d/
clear
ls
clear; ls
ll contrib/
cd ../hostapd/
ls
ls contrib/
vim contrib/AP 
vim /etc/hostapd/
vim contrib/hostapd.conf 
find / -name "*hostapd*"
vim /var/lib/dpkg/info/hostapd.conffiles 
vim /etc/init.d/hostapd 
vim /etc/default/hostapd 
ln -f /etc/default/hostapd /root/eaptls/hostapd/etc-default-hostapd
vim /etc/default/hostapd 
vim /etc/systemd/system/hostapd.service 
file /etc/systemd/system/hostapd.service 
vim /usr/share/doc/hostapd/examples/
cp /usr/share/doc/hostapd/examples/hostapd.conf.gz /etc/hostapd/hostapd.conf
ln -f /etc/hostapd/hostapd.conf /root/eaptls/hostapd/etc-hostapd-hostapd.conf
vim /etc/hostapd/hostapd.conf 
rm /root/eaptls/hostapd/etc-hostapd-hostapd.conf 
vim /usr/share/doc/hostapd/examples/hostapd.conf.gz 
cp /usr/share/doc/hostapd/examples/hostapd.conf.gz /tmp/
cd /tmp/
cp /usr/share/doc/hostapd/examples/hostapd.conf.gz .
ls
tar xvf hostapd.conf.gz
cat hostapd.conf.gz 
clear
vim hostapd.conf.gz 
file hostapd.conf.gz 
gzip -x ./hostapd.conf.gz
gzip --help
gzip -d ./hostapd.conf.gz
ls
mv hostapd.conf /etc/hostapd/
cd
clear
vim /root/share/eaptls/server/hostapd/hostapd/hostapd.conf 

ifdown wls7
brctl addbr apd

mv /usr/share/ca-certificates/BrainCraft.io_CertAuthority_PubCertificate.pem /usr/share/ca-certificates/extra/BrainCraft.io_CertAuthority_PubCertificate.crt
dpkg-reconfigure ca-certificates 

cp share/eaptls/server/hostapd/hostapd/hostapd.conf /etc/hostapd/

ln ../mods-enabled/eap /root/eaptls/radius/freeradius/

ln -f BrainCraft.io_CertAuthority_PubCertificate.pem /etc/freeradius/3.0/certs/BrainCraft.io_CertAuthority_PubCertificate.pem 
ln -f radius.braincraft.io_Certificate.pem /etc/freeradius/3.0/certs/radius.braincraft.io_Certificate.pem 
ln -f radius.braincraft.io_PrivateKey.pem /etc/freeradius/3.0/certs/radius.braincraft.io_PrivateKey.pem 

mv Makefile Makefile.sh
wget https://raw.githubusercontent.com/FreeRADIUS/freeradius-server/29add135c8d1f1f7ccc6ab6ca25af87b48575a5b/raddb/certs/Makefile

vim /etc/freeradius/3.0/mods-enabled/eap 

killall hostapd
clear; hostapd -dd -K -t /etc/hostapd/hostapd.conf

chown root:freerad /etc/freeradius/3.0/certs/*
chmod 0600 /etc/freeradius/3.0/certs/radius.braincraft.io_PrivateKey.pem 
chmod g+r /etc/freeradius/3.0/certs/radius.braincraft.io_PrivateKey.pem 

killall freeradius
clear; freeradius -X

netstat -lnw
netstat -ln
openssl s_client -showcerts -connect 172.0.0.1:1812 -prexit
mkdir wpa_supplicant
cd wpa_supplicant
wget http://w1.fi/releases/wpa_supplicant-2.6.tar.gz 
mv wpa_supplicant-2.6.tar.gz wpa_supplicant/
tar xvf wpa_supplicant-2.6.tar.gz 

apt-get install build-tools
apt install libnl-3-dev
apt-get install build-dep gcc build-essential
apt-get install gcc build-essential devscripts apt-rdepends packaging-dev
apt install libssl-dev libnl-3-dev libnl-genl-3-dev -y
pip install wpaspy

wget https://www.eduroam.cz/rad_eap_test/rad_eap_test-0.15.tar.bz2 
tar xvf rad_eap_test-0.15.tar.bz2 
./rad_eap_test --help
make eapol_test
cp -f /root/wpa_supplicant/wpa_supplicant-2.6/wpa_supplicant/eapol_test /usr/local/bin/
cp -f /root/wpa_supplicant/wpa_supplicant-2.6/wpa_supplicant/eapol_test .
clear; ./eapol_test -c eapol.conf -a172.0.0.1 -p1812

clear; freeradius -X
netstat -l
systemctl status hostapd
systemctl start hostapd
clear; hostapd -dd -K -t /etc/hostapd/hostapd.conf
